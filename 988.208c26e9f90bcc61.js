"use strict";(self.webpackChunkangular_sandbox=self.webpackChunkangular_sandbox||[]).push([[988],{4988:(oe,z,o)=>{o.r(z),o.d(z,{SuperheroesModule:()=>m});var y=o(6895),M=o(5861),B=o(1135),N=o(6451),Q=o(8421),F=o(9751),j=o(5577),U=o(1144),h=o(576),G=o(3268);const b=["addListener","removeListener"],D=["addEventListener","removeEventListener"],Y=["on","off"];function O(n,e,r,s){if((0,h.m)(r)&&(s=r,r=void 0),s)return O(n,e,r).pipe((0,G.Z)(s));const[i,p]=function w(n){return(0,h.m)(n.addEventListener)&&(0,h.m)(n.removeEventListener)}(n)?D.map(a=>c=>n[a](e,c,r)):function R(n){return(0,h.m)(n.addListener)&&(0,h.m)(n.removeListener)}(n)?b.map(A(n,e)):function X(n){return(0,h.m)(n.on)&&(0,h.m)(n.off)}(n)?Y.map(A(n,e)):[];if(!i&&(0,U.z)(n))return(0,j.z)(a=>O(a,e,r))((0,Q.Xf)(n));if(!i)throw new TypeError("Invalid event target");return new F.y(a=>{const c=(...l)=>a.next(1<l.length?l:l[0]);return i(c),()=>p(c)})}function A(n,e){return r=>s=>n[r](e,s)}var V=o(8372),t=o(4650),C=o(3905),H=o(4128),K=o(4004),T=o(663),d=o(2340),E=o(9080),W=o(529),q=o(2997);class u{constructor(e,r){this.http=e,this.store=r}getSuperheroById(e){return new Promise((r,s)=>{(0,C.z)(this.http.get(`${d.N.api.superheroes}/${e}`)).then(i=>{r(new T.j(i))}).catch(()=>s())})}getSuperheroBySearch(e){var r=this;return new Promise((s,i)=>{(0,C.z)(this.http.get(`${d.N.api.superheroes}/search/${e}`)).then(function(){var p=(0,M.Z)(function*(a){a.error&&i();const c=yield(0,C.z)(r.store.select(E.T)),l=a.results?.map(Z=>new T.j(Z,c.includes(parseInt(Z.id))))??[];s(l)});return function(a){return p.apply(this,arguments)}}()).catch(()=>i())})}getSuperheroes(e){var r=this;return new Promise(function(){var s=(0,M.Z)(function*(i,p){const a=d.N.totalEntries,c=d.N.pageSize,l=Math.ceil(a/10),J=c*(Math.min(Math.max(1,e),l)-1),ne=Math.min(c,Math.abs(a-J)),re=yield(0,C.z)(r.store.select(E.T));(0,C.z)((0,H.D)([...Array(ne)].map((v,L)=>L+1+J).map(v=>r.http.get(`${d.N.api.superheroes}/${v}`))).pipe((0,K.U)(v=>v.map(L=>new T.j(L,re.includes(parseInt(L.id))))))).then(v=>i(v)).catch(()=>p())});return function(i,p){return s.apply(this,arguments)}}())}}u.\u0275fac=function(e){return new(e||u)(t.LFG(W.eN),t.LFG(q.yh))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"});var $=o(1121),P=o(4006);function k(n,e){1&n&&(t.TgZ(0,"li",3),t._UZ(1,"app-thumb",4),t.qZA()),2&n&&(t.xp6(1),t.Q6J("loader",!0))}class S{constructor(){this.items=[],this.count=d.N.pageSize}ngOnChanges(e){"count"in e&&this.generateCards()}generateCards(){this.items=[...Array(this.count)]}}S.\u0275fac=function(e){return new(e||S)},S.\u0275cmp=t.Xpm({type:S,selectors:[["app-loader"]],inputs:{count:"count"},features:[t.TTD],decls:3,vars:1,consts:[[1,"loader"],[1,"items"],["class","item",4,"ngFor","ngForOf"],[1,"item"],[3,"loader"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"ul",1),t.YNc(2,k,2,1,"li",2),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",r.items))},dependencies:[y.sg,$.N],styles:[".loader[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{display:grid;grid-gap:30px;grid-template-columns:repeat(5,1fr);margin:0;padding:0;list-style-type:none}"]});const _=["input"];function ee(n,e){if(1&n&&(t.TgZ(0,"li",12),t._UZ(1,"app-thumb",13),t.qZA()),2&n){const r=e.$implicit;t.xp6(1),t.Q6J("superhero",r)}}class x{constructor(e){this.superhero=e,this.page=1,this.search="",this.superheroes$=new B.X([])}ngOnInit(){this.loadSuperheroes()}ngAfterViewInit(){this.searchListen(),this.scrollListen()}ngOnDestroy(){this.page=1}onSearch(){this.search.length>0&&this.loadSuperheroes()}loadSuperheroes(){var e=this;return(0,M.Z)(function*(){e.search.length>0?e.paginateSearch():e.paginate()})()}paginateSearch(){var e=this;return(0,M.Z)(function*(){e.page=1,e.superheroes$.next([]);try{const r=yield e.superhero.getSuperheroBySearch(e.search);e.superheroes$.next(r)}catch{}})()}paginate(){var e=this;return(0,M.Z)(function*(){1===e.page&&e.superheroes$.next([]);const r=yield e.superhero.getSuperheroes(e.page++),s=[...e.superheroes$.getValue(),...r];e.superheroes$.next(s)})()}searchListen(){(0,N.T)(O(this.input.nativeElement,"search"),O(this.input.nativeElement,"input")).pipe((0,V.b)(300)).subscribe(()=>this.loadSuperheroes())}scrollListen(){const e=document.querySelector("#cardLoader");new IntersectionObserver((i,p)=>{i.forEach(a=>{a.isIntersecting&&this.loadSuperheroes()})},{rootMargin:"0px",threshold:.1}).observe(e)}}x.\u0275fac=function(e){return new(e||x)(t.Y36(u))},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-superheroes"]],viewQuery:function(e,r){if(1&e&&t.Gf(_,5),2&e){let s;t.iGM(s=t.CRH())&&(r.input=s.first)}},decls:17,vars:5,consts:[[1,"root"],[1,"title"],[1,"content"],[1,"input","input--search"],[1,"input__label"],[1,"material-symbols-outlined","input__icon"],["autocomplete","","type","search","placeholder","Search for a superhero...",1,"input__field",3,"ngModel","ngModelChange"],["input",""],[1,"superheroes-wrapper"],[1,"superheroes"],["class","superheroe",4,"ngFor","ngForOf"],["id","cardLoader",3,"hidden"],[1,"superheroe"],[3,"superhero"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Superheroes"),t.qZA(),t.TgZ(3,"div",2)(4,"label",3)(5,"span",4)(6,"span",5),t._uU(7,"search"),t.qZA(),t._uU(8," Search "),t.qZA(),t.TgZ(9,"input",6,7),t.NdJ("ngModelChange",function(i){return r.search=i}),t.qZA()(),t.TgZ(11,"div",8)(12,"ul",9),t.YNc(13,ee,2,1,"li",10),t.ALo(14,"async"),t.qZA(),t.TgZ(15,"div",11),t._UZ(16,"app-loader"),t.qZA()()()()),2&e&&(t.xp6(9),t.Q6J("ngModel",r.search),t.xp6(4),t.Q6J("ngForOf",t.lcZ(14,3,r.superheroes$)),t.xp6(2),t.Q6J("hidden",r.search.length>0))},dependencies:[y.sg,$.N,P.Fj,P.JJ,P.On,S,y.Ov],styles:[".root[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .root[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;color:#1f1f1f;font-family:Bangers,cursive}.root[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:72px;margin-top:-24px}.root[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:18px;font-weight:400}.root[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{padding:20px;margin-top:20px;border-radius:5px;background-color:#2727276e}.superheroes-wrapper[_ngcontent-%COMP%]   .superheroes[_ngcontent-%COMP%]{margin:0 0 30px;padding:0;list-style-type:none;display:grid;grid-gap:30px;grid-template-columns:repeat(5,1fr)}",".input[_ngcontent-%COMP%]{display:flex;margin-bottom:25px;flex-direction:column}.input__label[_ngcontent-%COMP%]{color:#fff;font-weight:100;margin-bottom:5px;transition-duration:.2s;transition-property:color;display:flex;align-items:center}.input__icon[_ngcontent-%COMP%]{font-size:22px;margin-right:5px}.input__field[_ngcontent-%COMP%]{border:none;border-radius:5px;padding:10px 15px;background-color:#fff;font-weight:400;font-family:Noto Sans Display,sans-serif;transition-duration:.2s;transition-property:outline}.input__field[_ngcontent-%COMP%]:focus, .input__field[_ngcontent-%COMP%]:active{outline:none}.input__field[_ngcontent-%COMP%]:focus{outline:2px solid #080808}.input__error[_ngcontent-%COMP%]{margin:5px 0 0;font-size:14px;font-weight:300;color:#ff6e6e}.input[_ngcontent-%COMP%]:focus-within   .input__label[_ngcontent-%COMP%]{font-weight:500}"]});var te=o(5182),I=o(1251);class f{}f.\u0275fac=function(e){return new(e||f)},f.\u0275mod=t.oAB({type:f}),f.\u0275inj=t.cJS({imports:[y.ez,I.P]});class g{constructor(e){this.superheroes=e}resolve(e,r){return new F.y(s=>{const i=parseInt(e.paramMap.get("id")??"");this.superheroes.getSuperheroById(i).then(p=>s.next(p)).catch(p=>s.error(p))})}}g.\u0275fac=function(e){return new(e||g)(t.LFG(u))},g.\u0275prov=t.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"});class m{}m.\u0275fac=function(e){return new(e||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[y.ez,I.P,P.u5,f,te.Bz.forChild([{path:"",component:x},{path:":id",loadChildren:()=>o.e(160).then(o.bind(o,6160)).then(n=>n.DetailModule),resolve:{superhero:g}}])]})}}]);