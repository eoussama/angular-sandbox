"use strict";(self.webpackChunkangular_sandbox=self.webpackChunkangular_sandbox||[]).push([[228],{6228:(re,L,o)=>{o.r(L),o.d(L,{SuperheroesModule:()=>f});var P=o(6895),m=o(5861),$=o(1135),A=o(6451),I=o(8421),z=o(9751),J=o(5577),B=o(1144),u=o(576),N=o(3268);const Q=["addListener","removeListener"],j=["addEventListener","removeEventListener"],G=["on","off"];function S(t,e,r,s){if((0,u.m)(r)&&(s=r,r=void 0),s)return S(t,e,r).pipe((0,N.Z)(s));const[i,p]=function D(t){return(0,u.m)(t.addEventListener)&&(0,u.m)(t.removeEventListener)}(t)?j.map(a=>h=>t[a](e,h,r)):function U(t){return(0,u.m)(t.addListener)&&(0,u.m)(t.removeListener)}(t)?Q.map(E(t,e)):function R(t){return(0,u.m)(t.on)&&(0,u.m)(t.off)}(t)?G.map(E(t,e)):[];if(!i&&(0,B.z)(t))return(0,J.z)(a=>S(a,e,r))((0,I.Xf)(t));if(!i)throw new TypeError("Invalid event target");return new z.y(a=>{const h=(...l)=>a.next(1<l.length?l:l[0]);return i(h),()=>p(h)})}function E(t,e){return r=>s=>t[r](e,s)}var Y=o(8372),n=o(4650),v=o(3905),V=o(4128),X=o(4004),Z=o(663),y=o(2340),T=o(9080),b=o(529),H=o(2997);class c{constructor(e,r){this.http=e,this.store=r}getSuperheroById(e){return new Promise((r,s)=>{(0,v.z)(this.http.get(`${y.N.api.superheroes}/${e}`)).then(i=>{r(new Z.j(i))}).catch(()=>s())})}getSuperheroBySearch(e){var r=this;return new Promise((s,i)=>{(0,v.z)(this.http.get(`${y.N.api.superheroes}/search/${e}`)).then(function(){var p=(0,m.Z)(function*(a){a.error&&i();const h=yield(0,v.z)(r.store.select(T.T)),l=a.results?.map(C=>new Z.j(C,h.includes(parseInt(C.id))))??[];s(l)});return function(a){return p.apply(this,arguments)}}()).catch(()=>i())})}getSuperheroes(e){var r=this;return new Promise(function(){var s=(0,m.Z)(function*(i,p){const a=y.N.totalEntries,h=y.N.pageSize,l=Math.ceil(a/10),F=h*(Math.min(Math.max(1,e),l)-1),ne=Math.min(h,Math.abs(a-F)),te=yield(0,v.z)(r.store.select(T.T));(0,v.z)((0,V.D)([...Array(ne)].map((g,O)=>O+1+F).map(g=>r.http.get(`${y.N.api.superheroes}/${g}`))).pipe((0,X.U)(g=>g.map(O=>new Z.j(O,te.includes(parseInt(O.id))))))).then(g=>i(g)).catch(()=>p())});return function(i,p){return s.apply(this,arguments)}}())}}c.\u0275fac=function(e){return new(e||c)(n.LFG(b.eN),n.LFG(H.yh))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"});var K=o(1121),x=o(4006),W=o(8868);const w=["input"];function k(t,e){if(1&t&&(n.TgZ(0,"li",12),n._UZ(1,"app-thumb",13),n.qZA()),2&t){const r=e.$implicit;n.xp6(1),n.Q6J("superhero",r)}}class M{constructor(e){this.superhero=e,this.page=1,this.search="",this.superheroes$=new $.X([])}ngOnInit(){this.loadSuperheroes()}ngAfterViewInit(){this.searchListen(),this.scrollListen()}ngOnDestroy(){this.page=1}onSearch(){this.search.length>0&&this.loadSuperheroes()}loadSuperheroes(){var e=this;return(0,m.Z)(function*(){e.search.length>0?e.paginateSearch():e.paginate()})()}paginateSearch(){var e=this;return(0,m.Z)(function*(){e.page=1,e.superheroes$.next([]);try{const r=yield e.superhero.getSuperheroBySearch(e.search);e.superheroes$.next(r)}catch{}})()}paginate(){var e=this;return(0,m.Z)(function*(){1===e.page&&e.superheroes$.next([]);const r=yield e.superhero.getSuperheroes(e.page++),s=[...e.superheroes$.getValue(),...r];e.superheroes$.next(s)})()}searchListen(){(0,A.T)(S(this.input.nativeElement,"search"),S(this.input.nativeElement,"input")).pipe((0,Y.b)(300)).subscribe(()=>this.loadSuperheroes())}scrollListen(){const e=document.querySelector("#cardLoader");new IntersectionObserver((i,p)=>{i.forEach(a=>{a.isIntersecting&&this.loadSuperheroes()})},{rootMargin:"0px",threshold:.1}).observe(e)}}M.\u0275fac=function(e){return new(e||M)(n.Y36(c))},M.\u0275cmp=n.Xpm({type:M,selectors:[["app-superheroes"]],viewQuery:function(e,r){if(1&e&&n.Gf(w,5),2&e){let s;n.iGM(s=n.CRH())&&(r.input=s.first)}},decls:17,vars:5,consts:[[1,"root"],[1,"title"],[1,"content"],[1,"input","input--search"],[1,"input__label"],[1,"material-symbols-outlined","input__icon"],["autocomplete","","type","search","placeholder","Search for a superhero...",1,"input__field",3,"ngModel","ngModelChange"],["input",""],[1,"superheroes-wrapper"],[1,"superheroes"],["class","superheroe",4,"ngFor","ngForOf"],["id","cardLoader",3,"hidden"],[1,"superheroe"],[3,"superhero"]],template:function(e,r){1&e&&(n.TgZ(0,"div",0)(1,"h2",1),n._uU(2,"Superheroes"),n.qZA(),n.TgZ(3,"div",2)(4,"label",3)(5,"span",4)(6,"span",5),n._uU(7,"search"),n.qZA(),n._uU(8," Search "),n.qZA(),n.TgZ(9,"input",6,7),n.NdJ("ngModelChange",function(i){return r.search=i}),n.qZA()(),n.TgZ(11,"div",8)(12,"ul",9),n.YNc(13,k,2,1,"li",10),n.ALo(14,"async"),n.qZA(),n.TgZ(15,"div",11),n._UZ(16,"app-loader"),n.qZA()()()()),2&e&&(n.xp6(9),n.Q6J("ngModel",r.search),n.xp6(4),n.Q6J("ngForOf",n.lcZ(14,3,r.superheroes$)),n.xp6(2),n.Q6J("hidden",r.search.length>0))},dependencies:[P.sg,K.N,x.Fj,x.JJ,x.On,W.R,P.Ov],styles:[".root[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .root[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;color:#1f1f1f;font-family:Bangers,cursive}.root[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:72px;margin-top:-24px}.root[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:18px;font-weight:400}.root[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{padding:20px;margin-top:20px;border-radius:5px;background-color:#2727276e}.superheroes-wrapper[_ngcontent-%COMP%]   .superheroes[_ngcontent-%COMP%]{margin:0 0 30px;padding:0;list-style-type:none;display:grid;grid-gap:30px;grid-template-columns:repeat(5,1fr)}",".input[_ngcontent-%COMP%]{display:flex;margin-bottom:25px;flex-direction:column}.input__label[_ngcontent-%COMP%]{color:#fff;font-weight:100;margin-bottom:5px;transition-duration:.2s;transition-property:color;display:flex;align-items:center}.input__icon[_ngcontent-%COMP%]{font-size:22px;margin-right:5px}.input__field[_ngcontent-%COMP%]{border:none;border-radius:5px;padding:10px 15px;background-color:#fff;font-weight:400;font-family:Noto Sans Display,sans-serif;transition-duration:.2s;transition-property:outline}.input__field[_ngcontent-%COMP%]:focus, .input__field[_ngcontent-%COMP%]:active{outline:none}.input__field[_ngcontent-%COMP%]:focus{outline:2px solid #080808}.input__error[_ngcontent-%COMP%]{margin:5px 0 0;font-size:14px;font-weight:300;color:#ff6e6e}.input[_ngcontent-%COMP%]:focus-within   .input__label[_ngcontent-%COMP%]{font-weight:500}"]});var q=o(5182),_=o(1251),ee=o(40);class d{constructor(e){this.superheroes=e}resolve(e,r){return new z.y(s=>{const i=parseInt(e.paramMap.get("id")??"");this.superheroes.getSuperheroById(i).then(p=>s.next(p)).catch(p=>s.error(p))})}}d.\u0275fac=function(e){return new(e||d)(n.LFG(c))},d.\u0275prov=n.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"});class f{}f.\u0275fac=function(e){return new(e||f)},f.\u0275mod=n.oAB({type:f}),f.\u0275inj=n.cJS({imports:[P.ez,_.P,x.u5,ee.q,q.Bz.forChild([{path:"",component:M},{path:":id",loadChildren:()=>o.e(160).then(o.bind(o,6160)).then(t=>t.DetailModule),resolve:{superhero:d}}])]})}}]);